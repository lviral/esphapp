<link rel="import" href="../com/com-tipo-contrato.html">
<link rel="import" href="../com/com-servicio-pendiente.html">
<link rel="import" href="../com/com-tipos-id.html">

<dom-module id="vista-pagos">

  <template>

    <style>
      :host {
        display: block;
        padding: 10px;
      }

      h1 {
        font-size: 22px;
        margin: 16px 0;
        color: #212121;
      }
        
      .divTable {
       display: table;
       width: 90%;
       margin: 0 auto;
      }
      
      .divRow
      {
       display:table-row;
      }

      .divCell {
       display:table-cell;
       padding: 10px;
       vertical-align: middle;
      }
    </style>
      
        <div hidden$="{{vistaTipoContratoOculta}}">
            <paper-radio-group selected="porContrato" on-paper-radio-group-changed="_controlarCambioTipoBusqueda">
                <paper-radio-button name="porContrato">Por Contrato</paper-radio-button>
                <paper-radio-button name="porId">Por Identificacion</paper-radio-button>
            </paper-radio-group>
            <div hidden$="{{vistaBusquedaPorContratoOculta}}">
                <div class="divTable"> 
                    <div class="divRow">
                        <div class="divCell">
                             <paper-input label='Contrato' value='{{txtContratoConsulta}}'></paper-input>
                        </div>
                        <div class="divCell">
                            <paper-fab icon="add" mini="true" on-click='_agregarTipoContrato'></paper-fab>
                        </div>
                    </div>
                </div>
            </div>
            <div hidden$="{{vistaBusquedaPorIdOculta}}">
                <com-tipos-id></com-tipos-id>
            </div>
            
            <div id="listaTipoContrato">
            </div>
            
            <paper-fab icon="arrow-forward" mini="true" on-click='_mostrarVistaFacturas'></paper-fab>
        </div>
      
        <div hidden$="{{vistaFacturasOculta}}">
            <paper-checkbox on-change="_controlarSeleccionarTodos">Seleccionar todos</paper-checkbox>
                <div id="listaServiciosPendientes">
                    <com-servicio-pendiente contrato="5300" codigo-tipo-servicio="1"></com-servicio-pendiente>
                </div>
            <paper-fab icon="arrow-back" mini="true" on-click='_mostrarVistaTipoContrato'></paper-fab>
        </div>
    
  </template>

  <script>

    Polymer({

      is: 'vista-pagos',
        
      properties: {
        vistaBusquedaPorContratoOculta: Boolean,
        vistaBusquedaPorIdOculta: Boolean,
        vistaTipoContratoOculta: Boolean,
        vistaFacturasOculta: Boolean
      },
        
      ready: function() {
          
          this.vistaBusquedaPorContratoOculta = false;
          this.vistaBusquedaPorIdOculta = true;
          this.vistaTipoContratoOculta = false;
          this.vistaFacturasOculta = true;
      },
      
      _agregarTipoContrato: function() {
          var tipoContratoElem = document.createElement("com-tipo-contrato");
          tipoContratoElem.setAttribute("contrato", this.txtContratoConsulta);
          this.$.listaTipoContrato.appendChild(tipoContratoElem);  
      },
        
      _mostrarVistaFacturas: function() {
          //if(this.listaContratos.length > 0) {
              this.vistaFacturasOculta= false;
              this.vistaTipoContratoOculta= true;
          
          
              var listaContratos = Polymer.dom(this.$.listaTipoContrato).querySelectorAll('com-tipo-contrato');
              listaContratos.forEach(function(tipoContrato){
                  console.log(tipoContrato.contrato);
              });
          //    this.paramConsultarFacturasPendientes = this.listaTipoContrato;
         // }
        //  else {
        //      this.$.toastNohayContratos.open();
        //  }
      },
        
      _mostrarVistaTipoContrato: function() {
          this.vistaFacturasOculta= true;
          this.vistaTipoContratoOculta= false;
      },
        
      _controlarCambioTipoBusqueda: function(e) {
          if(e.target.selected=='porContrato') {
              this.vistaBusquedaPorContratoOculta = false;
              this.vistaBusquedaPorIdOculta = true;
          }
          else {
              this.vistaBusquedaPorContratoOculta = true;
              this.vistaBusquedaPorIdOculta = false;
          }
      }
     
    });

  </script>

</dom-module>
